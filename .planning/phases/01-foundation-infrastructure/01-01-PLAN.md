---
phase: 01-foundation-infrastructure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - tsconfig.json
  - next.config.ts
  - src/app/layout.tsx
  - src/app/page.tsx
  - .env
  - .env.local
  - .gitignore
  - src/types/index.ts
autonomous: true

must_haves:
  truths:
    - "Next.js application starts locally with npm run dev and shows a page at http://localhost:3000"
    - "TypeScript strict mode is enabled and enforced on build"
    - "Project uses src/ directory with App Router structure"
  artifacts:
    - path: "package.json"
      provides: "Next.js 16+ project with TypeScript dependencies"
      contains: "next"
    - path: "tsconfig.json"
      provides: "TypeScript strict mode configuration"
      contains: "strict"
    - path: "next.config.ts"
      provides: "Next.js configuration with strict TypeScript build enforcement"
      contains: "ignoreBuildErrors"
    - path: "src/app/layout.tsx"
      provides: "Root layout with html and body tags"
      contains: "RootLayout"
    - path: "src/app/page.tsx"
      provides: "Home page placeholder"
      min_lines: 5
    - path: ".env"
      provides: "Environment variable placeholders committed to git"
      contains: "DATABASE_URL"
    - path: "src/types/index.ts"
      provides: "Shared TypeScript types barrel file"
      min_lines: 1
  key_links:
    - from: "next.config.ts"
      to: "tsconfig.json"
      via: "TypeScript strict build enforcement"
      pattern: "ignoreBuildErrors.*false"
    - from: "src/app/layout.tsx"
      to: "src/app/page.tsx"
      via: "App Router renders page inside layout"
      pattern: "children"
---

<objective>
Scaffold the Next.js project with TypeScript strict mode, App Router structure, and environment configuration.

Purpose: Establishes the foundational project structure that all subsequent phases build upon. TypeScript strict mode must be enabled from day one -- it is extremely difficult to retrofit later. The src/ directory and App Router conventions set the pattern for the entire codebase.

Output: A running Next.js application at localhost:3000 with TypeScript strict mode, proper project structure, and environment variable templates.
</objective>

<execution_context>
@C:/Users/gary_/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/gary_/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-infrastructure/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Scaffold Next.js project with TypeScript and App Router</name>
  <files>
    package.json
    tsconfig.json
    next.config.ts
    src/app/layout.tsx
    src/app/page.tsx
    .gitignore
  </files>
  <action>
    Run create-next-app to scaffold the project in the CURRENT directory (not a subdirectory). The project directory already exists, so use "." as the project name:

    ```bash
    npx create-next-app@latest . --typescript --tailwind --eslint --app --turbopack --import-alias "@/*" --use-npm
    ```

    If prompted interactively, answer:
    - TypeScript: Yes
    - ESLint: Yes
    - Tailwind CSS: Yes
    - src/ directory: Yes
    - App Router: Yes
    - Turbopack: Yes
    - Import alias: @/*

    After scaffolding completes:

    1. Verify tsconfig.json has `"strict": true` (create-next-app should set this). If not present, add it under compilerOptions.

    2. Update next.config.ts to enforce strict TypeScript on builds:
    ```typescript
    import type { NextConfig } from 'next'

    const nextConfig: NextConfig = {
      reactStrictMode: true,
      typescript: {
        ignoreBuildErrors: false,
      },
    }

    export default nextConfig
    ```

    3. Replace the default src/app/page.tsx with a minimal placeholder:
    ```tsx
    export default function Home() {
      return (
        <main className="flex min-h-screen flex-col items-center justify-center p-24">
          <h1 className="text-4xl font-bold">MessageMapper</h1>
          <p className="mt-4 text-lg text-gray-600">Visual message format mapping platform</p>
        </main>
      )
    }
    ```

    4. Ensure .gitignore includes standard Next.js entries plus: .env.local, .env*.local, node_modules/, .next/, .vercel/
  </action>
  <verify>
    Run `npm run dev` and confirm the dev server starts without errors. Run `npm run build` and confirm it completes with zero TypeScript errors. Visit http://localhost:3000 and confirm "MessageMapper" heading renders.
  </verify>
  <done>Next.js dev server starts at localhost:3000 showing MessageMapper placeholder page. Build completes with zero errors. TypeScript strict mode is active in tsconfig.json. App Router structure exists under src/app/.</done>
</task>

<task type="auto">
  <name>Task 2: Configure environment variables and shared types foundation</name>
  <files>
    .env
    .env.local
    src/types/index.ts
  </files>
  <action>
    1. Create .env (committed to git) with placeholder values for documentation:
    ```bash
    # Database connection (PostgreSQL)
    DATABASE_URL="postgresql://localhost:5432/messagemapper_dev"

    # Direct connection URL (for migrations, bypasses connection pooling)
    DIRECT_URL="postgresql://localhost:5432/messagemapper_dev"
    ```

    2. Create .env.local (NOT committed to git, already in .gitignore) with actual local dev values:
    ```bash
    # Local development database
    # Replace with your Neon/Supabase connection string for cloud DB
    DATABASE_URL="postgresql://localhost:5432/messagemapper_dev"
    DIRECT_URL="postgresql://localhost:5432/messagemapper_dev"
    ```

    3. Create src/types/index.ts as the shared types barrel file with initial multi-tenant types that Prisma will later extend:
    ```typescript
    // Shared TypeScript types for MessageMapper
    // Prisma-generated types will be the source of truth for database models.
    // This file holds application-level types that extend or compose Prisma types.

    /** Role within a tenant workspace */
    export type WorkspaceRole = 'admin' | 'editor' | 'viewer'

    /** Session context for multi-tenant operations */
    export interface TenantContext {
      tenantId: string
      userId: string
      role: WorkspaceRole
    }

    /** Standard API error response shape */
    export interface ApiError {
      error: string
      code?: string
      details?: Record<string, string[]>
    }

    /** Standard API success response wrapper */
    export interface ApiResponse<T> {
      data: T
      meta?: {
        total?: number
        page?: number
        pageSize?: number
      }
    }
    ```

    4. Verify .env.local is listed in .gitignore (should already be from create-next-app).
  </action>
  <verify>
    Run `npx tsc --noEmit` to confirm the types file compiles without errors. Verify .env.local is in .gitignore by running `grep "env.local" .gitignore`. Verify .env exists with DATABASE_URL placeholder.
  </verify>
  <done>.env file exists with DATABASE_URL placeholder (committed). .env.local exists with local dev values (gitignored). src/types/index.ts exports WorkspaceRole, TenantContext, ApiError, and ApiResponse types. All TypeScript compiles cleanly.</done>
</task>

</tasks>

<verification>
1. `npm run dev` starts without errors
2. `npm run build` completes with zero TypeScript errors
3. http://localhost:3000 shows MessageMapper heading
4. `grep "strict" tsconfig.json` shows strict: true
5. `npx tsc --noEmit` passes with no errors
6. .env exists with DATABASE_URL placeholder
7. .env.local is gitignored
</verification>

<success_criteria>
- Next.js application runs locally at localhost:3000
- TypeScript strict mode enabled and enforced on build
- App Router structure in src/app/ with layout and page
- Environment variable template committed, secrets gitignored
- Shared types foundation ready for Prisma model extensions
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-infrastructure/01-01-SUMMARY.md`
</output>
